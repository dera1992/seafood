{% extends "base.html" %}
{% load humanize %}

{% block title %}Payment Failed{% endblock %}

{% block content %}
  <div class="max-w-3xl mx-auto space-y-6">
    <div class="bg-white rounded-xl shadow p-6 space-y-4">
      <h1 class="text-2xl font-semibold text-gray-900">Payment failed</h1>
      <p class="text-sm text-gray-500">Hi {{ payment.user.get_full_name|default:payment.user.email }}, we couldn’t complete your payment.</p>

      <div class="rounded-lg border border-gray-200 p-4">
        <p class="text-sm text-gray-600">Reference: <span class="font-semibold text-gray-900">{{ payment.ref }}</span></p>
        <p class="text-sm text-gray-600">Date: <span class="font-semibold text-gray-900">{{ payment.date_ordered }}</span></p>
      </div>

      <div>
        <h2 class="text-lg font-semibold text-gray-900">Order summary</h2>
        <ul class="mt-3 space-y-2 text-sm text-gray-600">
          {% for ord_item in payment.items.all %}
            <li class="flex flex-wrap justify-between gap-2">
              <span>{{ ord_item.item.title }} × {{ ord_item.quantity }}</span>
              <span>£{{ ord_item.get_total|intcomma }}</span>
            </li>
          {% empty %}
            <li>No items were found for this payment.</li>
          {% endfor %}
        </ul>
      </div>

      <p class="text-sm text-gray-500">Please try again or contact support if the issue persists.</p>
      <a class="inline-flex items-center rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700" href="{% url 'order:checkout' %}">Return to checkout</a>
    </div>
  </div>
{% endblock %}
